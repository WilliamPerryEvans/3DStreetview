{% extends 'admin/model/edit.html' %}
{% block body %}
    <div id="flash"></div>
    <input type="hidden" id="mesh_id" value="{{model.id}}" />

{% block edit_form %}
    <div class="container">
        <h4>Mesh generation for {{ model }}</h4>
        <div class="shadow-sm p-3 mb-5 bg-white rounded">
            <div class="row">
                <div class="col">
                    <h5>Select photos</h5>
                </div>
                <div class="col">
                    <h5>OpenDroneMap task</h5>
                    <div class="tab">
                        <button class="tablinks" id="formButton" onclick="openTab(event, 'form_view')">Select ODM task</button>
                        <button class="tablinks" id="taskButton" onclick="openTab(event, 'task_view')">Edit ODM task</button>
                    </div>
                        <!-- Tab content -->
                    <div id="form_view" class="tabcontent">
                        <div class="form-group ">
                            <label for="odm_config" class="control-label">Server</label>
                            <select class="form-control" data-role="select2" id="odm_config" onchange="get_odm_projects()" name="odm_config" required>
                                <option disabled selected value> -- select an option -- </option>
                            {% for config in odm_configs %}
                                <option value="{{ config.id }}">{{ config }}</option>
                            {% endfor %}
                            </select>
                            <div class="btn-toolbar">
                                <button type="button" id="server_button" class="btn btn-primary mt-2" onClick="location.href='{{ url_for('odmconfig.create_view') }}';">New server</button>
                            </div>
                        </div>
                        <div class="form-group ">
                            <label for="odm_project" class="control-label">Project</label>
                            <select class="form-control" data-role="select2" id="odm_project" onchange="get_odm_tasks()" name="odm_project" required>
                            </select>
                            <div class="btn-toolbar">
                                <button type="button" id="project_create_button" disabled="true" data-toggle="modal" data-target="#newProject" class="btn btn-primary mt-2 mx-2" >New project</button>
                                <button type="button" id="project_delete_button" disabled="true" class="btn btn-danger mt-2 mx-2">Delete project</button>
                                <!-- Modal fpr new Project-->
                                <div class="modal fade" id="newProject" tabindex="-1" role="dialog" aria-labelledby="newProjectLabel" aria-hidden="true">
                                  <div class="modal-dialog" role="document">
                                    <div class="modal-content">
                                      <div class="modal-header">
                                        <h5 class="modal-title" id="newProjectLabel">New ODM Project</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                          <span aria-hidden="true">&times;</span>
                                        </button>
                                      </div>
                                      <div class="modal-body">
                                        <div class="form-group ">
                                            <label for="odm_project_name" class="control-label">Name</label>
                                            <input class="form-control" id="odm_project_name" name="name" required="" type="text" value="">
                                            <label for="odm_project_desc" class="control-label">Description (optional)</label>
                                            <textarea class="form-control" id="odm_project_desc" rows="3"></textarea>
                                        </div>
                                      </div>
                                      <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                        <button type="button" class="btn btn-primary">Save changes</button>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <!-- Modal fpr new Project-->
                            </div>
                        </div>
                        <div class="form-group ">
                            <label for="odm_task" class="control-label">Task</label>
                            <select class="form-control" data-role="select2" id="odm_task" name="odm_task" required>
                            </select>
                            <div class="btn-toolbar">
                                <button type="button" id="task_button" disabled="true" class="btn btn-primary mt-2 mx-2" onclick="get_odm_task()">Edit</button>
                                <button type="button" id="task_create_button" disabled="true" class="btn btn-primary mt-2 mx-2">Create</button>
                                <button type="button" id="task_delete_button" disabled="true" class="btn btn-danger mt-2 mx-2">Delete</button>
                            </div>
                        </div>
                    </div>
                    <div id="task_view" class="tabcontent">
                        <div class="row">
                            <div class="col name" id="task_id"><span></span></div>
                        </div>
                        <div class="row">
                            <div class="col-sm-3 details" id="images_count"><i class="far fa-image"></i><span></span></div>
                        </div>
                        <div class="row">
                            <div class="col-sm-3 details" id="processing_time"><i class="far fa-clock"></i><span></span></div>
                        </div>
                        <div class="row">
                            <div class="col">Upload progress</div>
                        </div>
                        <div class="progress">
                            <div class="progress-bar" role="progressbar" aria-valuenow="0" style="width: 0%;" aria-valuemin="0" aria-valuemax="100" id="upload_progress">Upload progress</div>
                        </div>
                        <div class="row">
                            <div class="col">Process progress</div>
                        </div>
                        <div class="progress">
                            <div class="progress-bar" role="progressbar" aria-valuenow="0" style="width: 0%;" aria-valuemin="0" aria-valuemax="100" id="running_progress">Processing...</div>
                        </div>
                        <br>
                        <div class="row">
                            <div class="col">
                                <div class="btn-group" role="group" aria-label="Basic example">
                                    <button type="button" class="btn btn-primary mx-1"><i class="fas fa-cloud-download-alt"></i> Download 3D mesh</button>
                                    <button type="button" class="btn btn-primary mx-1"><i class="fas fa-play-circle"></i>Launch task</button>
                                    <button type="button" class="btn btn-primary mx-1"><i class="fas fa-stop-circle"></i>Cancel task</button>
                                    <button type="button" class="btn btn-danger"><i class="fas fa-trash-alt"></i> Delete</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% endblock %}

{% block tail %}
    {{ super() }}
    <script src="{{ url_for('static', filename='js/mesh/edit.js') }}"></script>
{% endblock %}